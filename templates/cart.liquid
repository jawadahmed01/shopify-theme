{% if cart.item_count > 0 %}
  <div class="cart-page">
    <h1>Your Shopping Cart</h1>

    <form action="/cart" method="post" novalidate>
      <table class="cart-table">
        <thead>
          <tr>
            <th>Product</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Total</th>
            <th>Remove</th>
          </tr>
        </thead>
        <tbody>
          {% for item in cart.items %}
            <tr class="cart-item">
              <td>
                <div class="cart-item-info">
                  <img src="{{ item.image | img_url: '80x80' }}" alt="{{ item.title }}">
                  <div>
                    <a href="{{ item.url }}">{{ item.product.title }}</a>
                    {% if item.variant.title != 'Default Title' %}
                      <p>{{ item.variant.title }}</p>
                    {% endif %}
                  </div>
                </div>
              </td>
              <td>{{ item.price | money }}</td>
              <td>
                <input
                  type="number"
                  name="updates[]"
                  value="{{ item.quantity }}"
                  min="0"
                  data-line="{{ forloop.index }}"
                  class="quantity-input"
                >
              </td>
              <td>{{ item.line_price | money }}</td>
              <td>
                <a href="/cart/change?line={{ forloop.index }}&quantity=0" class="remove-btn">Remove</a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="cart-footer">
        <div class="cart-subtotal">
          <p>
            Subtotal: <span>{{ cart.total_price | money }}</span>
          </p>
        </div>
        <div class="cart-buttons">
          <button type="submit" name="update" class="update-btn">Update Cart</button>
          <button type="submit" name="checkout" class="checkout-btn">Checkout</button>
        </div>
      </div>
    </form>
  </div>
{% else %}
  <div class="empty-cart">
    <h2>Your cart is empty</h2>
    <a href="/collections/all" class="continue-shopping">Continue Shopping</a>
  </div>
{% endif %}

<style>
  .cart-page {
    padding: 2rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  .cart-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 2rem;
  }

  .cart-table th,
  .cart-table td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid #ddd;
  }

  .cart-item-info {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .cart-item-info img {
    max-width: 100px;
    height: auto;
  }

  .quantity-input {
    width: 60px;
    padding: 0.5rem;
    border: 1px solid #ddd;
  }

  .remove-btn {
    color: #ff0000;
    text-decoration: none;
    font-size: 1.5rem;
    font-weight: bold;
  }

  .cart-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 0;
  }

  .cart-subtotal {
    font-size: 1.2rem;
    font-weight: bold;
  }

  .cart-buttons {
    display: flex;
    gap: 1rem;
  }

  .update-btn,
  .checkout-btn {
    padding: 0.8rem 1.5rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
  }

  .update-btn {
    background-color: #f0f0f0;
    color: #333;
  }

  .checkout-btn {
    background-color: #000;
    color: white;
  }

  .empty-cart {
    text-align: center;
    padding: 4rem 2rem;
  }

  .continue-shopping {
    display: inline-block;
    margin-top: 1rem;
    padding: 0.8rem 1.5rem;
    background-color: #000;
    color: white;
    text-decoration: none;
    border-radius: 4px;
  }
</style>

<script>
  document.querySelectorAll('.quantity-input').forEach((input) => {
    input.addEventListener('change', function () {
      if (this.value < 0) this.value = 0;
    });
  });
</script>
